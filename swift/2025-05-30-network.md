## GCD (Grand Center Dispatch)

- Queue â‰  Thread: íëŠ” ì‘ì—…ì„ ë‹´ëŠ” ë¦¬ìŠ¤íŠ¸ì´ê³ , ìŠ¤ë ˆë“œëŠ” ì‹¤ì œ ì‹¤í–‰ ë‹¨ìœ„
- Thread - Queue â† Code(WorkItem): íì— ì‘ì—…ì„ ë“±ë¡í•˜ë©´ ìŠ¤ë ˆë“œê°€ ì´ë¥¼ ì‹¤í–‰
- `sync`, `async`ëŠ” íì— Work Itemì„ ì¶”ê°€í•˜ëŠ” ë°©ì‹, ë™ê¸°í™” ìì²´ë¥¼ ì˜ë¯¸ X

<br />

### QoS (Quality of Service)

- ì‘ì—…ì˜ ìš°ì„ ìˆœìœ„ì™€ ë¦¬ì†ŒìŠ¤ ë°°ë¶„ ì •ë„ë¥¼ ì„¤ì •

<br />

### ì‘ì—… ì·¨ì†Œ ê¸°ëŠ¥ êµ¬í˜„

1. `DispatchWorkItem` í´ë˜ìŠ¤ë¥¼ ì´ìš©í•´ ì‘ì—… ìƒì„±
2. `isCancelled` ì†ì„±ì„ ì§ì ‘ í™•ì¸í•˜ì—¬ ì‘ì—… ì¤‘ë‹¨ ì²˜ë¦¬

```swift
var currentWorkItem: DispatchWorkItem?
// Work Item ë‹¨ë… ì‹¤í–‰ ê°€ëŠ¥! ë³´í†µì€ ë””ìŠ¤íŒ¨ì¹˜ íì— ì¶”ê°€í•˜ëŠ” ë°©ì‹!

@IBAction func submitWorkItem(_ sender: Any) {
    currentWorkItem = DispatchWorkItem { [weak self] in
        for num in 0..<100 {
            // ì‹¤ì œë¡œ ì·¨ì†Œ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•¨
            if let item = self?.currentWorkItem, item.isCancelled {
                print("ì‘ì—… ì·¨ì†Œ")
                return
            }
            print(num, terminator: " ")
            Thread.sleep(forTimeInterval: 0.1)
        }
    }

    if let currentWorkItem {
        concurrentQueue.async(execute: currentWorkItem)
    }

    currentWorkItem?.notify(queue: .main) {
        print("Done")
    }
}

@IBAction func cancelWorkItem(_ sender: Any) {
    currentWorkItem?.cancel()
}
```

- ì‘ì—… ë‚´ë¶€ì—ì„œ `isCancelled`ë¥¼ í™•ì¸í•´ ì§ì ‘ ì¤‘ë‹¨ ë¡œì§ êµ¬í˜„ í•„ìš”
- `cancel()`ì€ ì‘ì—…ì„ ì¤‘ë‹¨í•˜ì§€ ì•Šê³ , `isCancelled` í”Œë˜ê·¸ë§Œ `true`ë¡œ ì„¤ì •

<br />

### Group Task ì²˜ë¦¬

- ì—¬ëŸ¬ ì‘ì—…ì„ í•˜ë‚˜ì˜ ê·¸ë£¹ìœ¼ë¡œ ë¬¶ê³ , ì™„ë£Œ ì‹œì ì— í•œë²ˆì— ì²˜ë¦¬ ê°€ëŠ¥

```swift
let group = DispatchGroup()

@IBAction func runAsGroup(_ sender: Any) {
    concurrentQueue.async(group: group) {
        for _ in 0..<10 {
            print("ğŸ", separator: "", terminator: "")
            Thread.sleep(forTimeInterval: 0.1)
        }
		}

    concurrentQueue.async(group: group) {
        for _ in 0..<10 {
            print("ğŸ", separator: "", terminator: "")
            Thread.sleep(forTimeInterval: 0.2)
        }
    }

    concurrentQueue.async(group: group) {
        for _ in 0..<10 {
            print("ğŸ‹", separator: "", terminator: "")
            Thread.sleep(forTimeInterval: 0.2)
        }
    }

    group.notify(queue: .main) {
        print("Done Group Task")
				// ì˜ˆ: íŒŒì‹± ê²°ê³¼ë¡œ UI ì—…ë°ì´íŠ¸
    }
}
```

<br />

## Network

### URL êµ¬ì¡°ì™€ êµ¬ì„± ìš”ì†Œ

```swift
let url = URL(string: "https://www.youtube.com/watch?v=ABCDEFG")!
```

- `scheme`: í†µì‹  í”„ë¡œí† ì½œ (ì˜ˆ: `http`, `https`, `ftp`, `ssh`, â€¦)
- `host`: ë„ë©”ì¸ (ì˜ˆ: `www.youtube.com`)
- `port`: ì ‘ì† í¬íŠ¸ (ì˜ˆ: `8080`)
- `path`: ë¦¬ì†ŒìŠ¤ ìœ„ì¹˜ (ì˜ˆ: `/watch`)
- `query`: ìš”ì²­ íŒŒë¼ë¯¸í„° (ì˜ˆ: `v=ABCDEFG`)

<br />

### í¼ì„¼íŠ¸ ì¸ì½”ë”©

- URLì— í•œê¸€/ê³µë°±/íŠ¹ìˆ˜ë¬¸ì í¬í•¨ì‹œ ì‚¬ìš©

```swift
"í•œê¸€ì¿¼ë¦¬".addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed)
```

<br />

### ìƒíƒœ ì½”ë“œì™€ ì„œë²„ ì²˜ë¦¬ ë°©ì‹

- 404 Not Found: URLì´ ì˜ëª»ëê±°ë‚˜ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë°ì´í„°
- 200 OK: ìš”ì²­ ì„±ê³µ, ë°ì´í„° ì¡´ì¬ ì—¬ë¶€ëŠ” ì‘ë‹µ ë°ì´í„°ë¡œ íŒë‹¨

<br />

### URLSession ê¸°ë³¸ êµ¬ì¡°

```swift
// URLë¡œ ìš”ì²­(Request)ì„ ë³´ë‚´ê³ ,
// ì„œë²„ì—ì„œ ì‘ë‹µ(Response)ì´ ì˜¤ë©´ í´ë¡œì €(completionHandler) í˜¸ì¶œ
let task = URLSession.shared.dataTask(with: url) { data, response, error in
		// data: ì„œë²„ì—ì„œ ì „ë‹¬ëœ ê²°ê³¼, ë°”ì´ë„ˆë¦¬ ë°ì´í„°
		// response: ì‘ë‹µ ì •ë³´ ë³´í†µ ìƒíƒœ ì½”ë“œ í™•ì¸í•  ë•Œ í•„ìš”

		// 1. ì—ëŸ¬ í™•ì¸
		// 2. ì‘ë‹µ(response) -> HTTPURLResponse -> statusCode
		// 3. ë°ì´í„° ì¡´ì¬ í™•ì¸
		// 4. ë°ì´í„° íŒŒì‹± (ë””ì½”ë”© ë“±)
}

task.resume()
```

- URLSession ì¢…ë¥˜
    - Data Task: ì•„ì£¼ ì‘ì€ ë°”ì´ë„ˆë¦¬/í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ë•Œ, API ì—°ë™í•  ë•Œ
    - Upload/Download Task: íŒŒì¼ ì „ì†¡, ë°±ê·¸ë¼ìš´ë“œ ì „ì†¡ ì§€ì›
    - Websocket Task: ì±„íŒ…, ì €ì§€ì—° ì „ì†¡, TCP

<br />

### JSON ë””ì½”ë”©

- ì„œë²„ê°€ `{}`í˜•íƒœë¡œ JSONì„ ë³´ë‚¸ë‹¤ë©´, `Decodable` í”„ë¡œí† ì½œ ì¶”ê°€ í•„ìˆ˜

```swift
struct Books: Decodable {
    let totalCount: Int
    let code: Int
    let message: String?
    let list: [Book]

    struct Book: Decodable {
        let id: Int
        let title: String
        let summary: String
        let storeLink: String
        let publicationDate: String
    }
}

JSONDecoder().decode(Books.self, from: dataFromServer)
```

<br />

### ì „ì²´ ë„¤íŠ¸ì›Œí¬ ì²˜ë¦¬ ì˜ˆì‹œ

```swift
var url = URL(string: "https://example.azurewebsites.net/books")!
url.append(queryItems: [URLQueryItem(name: "apiKey", value: "estkdtios2")])

let task = URLSession.shared.dataTask(with: url) { data, response, error in
    if let error {
	      print(error)
				return
    }

    guard let httpResponse = response as? HTTPURLResponse,
			    httpResponse.statusCode == 200,
			    let data else {
        return
    }

    do {
        let books = try JSONDecoder().decode(Books.self, from: data)
        if let str = books.list.first?.storeLink,
	         let url = URL(string: str) {
						print(url)
        }
    } catch {
        print(error)
    }
}

task.resume()
```

<br />

### í—¤ë”ì— ì •ë³´ ë‹´ì•„ì„œ ë³´ë‚´ê¸°

```swift
var urlRequest = URLRequest(url: url)
// key: "api-version", value: "2.0"
urlRequest.addValue("2.0", forHTTPHeaderField: "api-version")

let task = URLSession.shared.dataTask(with: urlRequest) {...}
task.resume()
```

<br />

## WebKit View

- ì•± ë‚´ì—ì„œ ì›¹ ë·° í‘œì‹œí•˜ê¸°
- `WKWebView` ì¶”ê°€ â†’ `URLRequest()` ë§Œë“¤ê¸° â†’ `load()` í˜¸ì¶œ

```swift
import UIKit
import WebKit

class LinkViewController: UIViewController {
    var url: URL?

    @IBOutlet weak var webView: WKWebView!

    override func viewDidLoad() {
        super.viewDidLoad()

        if let url {
            let request = URLRequest(url: url)
            webView.load(request)
        }
    }
}
```

- `Crash` ë°œìƒì‹œ, `Webkit.framework` í”„ë¡œì íŠ¸ì— ì¶”ê°€

  <img width="750" src="https://github.com/user-attachments/assets/95f1cbf2-01e9-4a39-925a-7d374ed97745" />
